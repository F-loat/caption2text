(function(t){function e(e){for(var r,i,s=e[0],c=e[1],l=e[2],f=0,p=[];f<s.length;f++)i=s[f],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&p.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(p.length)p.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={app:0},o=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/caption2text/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var r=n("85ec"),a=n.n(r);a.a},"4f49":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Index")},o=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{directives:[{name:"resize",rawName:"v-resize",value:t.resizeHandler,expression:"resizeHandler"}]},[n("v-app-bar",{attrs:{app:"",dark:"",color:"primary"}},[n("v-toolbar-title",{staticClass:"white--text"},[t._v("字幕转换工具")]),n("v-spacer"),n("v-btn",{attrs:{icon:"",dark:""},domProps:{textContent:t._s("<-")},on:{click:t.syncSource}}),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{text:"",dark:""},on:{click:t.switchEncoding}},"v-btn",a,!1),r),[t._v(" "+t._s(t.encoding)+" ")])]}}])},[n("span",[t._v("编码切换")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:"",dark:""},on:{click:t.switchFormat}},"v-btn",a,!1),r),[t._v(" "+t._s(t.files[0].format)+" ")])]}}])},[n("span",[t._v("格式切换")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:"",dark:""},on:{click:t.switchInvert}},"v-btn",a,!1),r),[n("v-icon",[t._v("mdi-call-split")])],1)]}}])},[n("span",[t._v("顺序切换")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:"",dark:""},on:{click:t.switchRange}},"v-btn",a,!1),r),[n("v-icon",[t._v("mdi-google-translate")])],1)]}}])},[n("span",[t._v("范围切换")])]),n("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,a=e.attrs;return[n("a",t._g(t._b({attrs:{href:"https://img.alicdn.com/imgextra/i2/O1CN01VhAWVx25SV6pfoc7C_!!6000000007525-0-tps-720-720.jpg",target:"_blank"}},"a",a,!1),r),[n("v-btn",{attrs:{icon:"",dark:""}},[n("v-icon",[t._v("mdi-arm-flex")])],1)],1)]}}])},[n("span",[t._v("赞赏")])]),n("a",{attrs:{href:"https://github.com/F-loat/caption2text",target:"_blank"}},[n("v-btn",{attrs:{icon:"",dark:""}},[n("v-icon",[t._v("mdi-github")])],1)],1)],1),n("v-main",[n("div",{staticClass:"main",on:{drop:function(e){return e.preventDefault(),t.dropFile(e)}}},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.files[0].source,expression:"files[0].source"}],ref:"source",staticClass:"source",attrs:{placeholder:"支持多文件拖入",spellcheck:"false"},domProps:{value:t.files[0].source},on:{input:[function(e){e.target.composing||t.$set(t.files[0],"source",e.target.value)},t.syncResult]}}),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.files[0].result,expression:"files[0].result"}],ref:"result",staticClass:"result",attrs:{placeholder:"支持批量导出",spellcheck:"false"},domProps:{value:t.files[0].result},on:{input:function(e){e.target.composing||t.$set(t.files[0],"result",e.target.value)}}})]),n("v-btn",{staticClass:"file-btn",attrs:{color:"secondary",dark:"",fixed:"",bottom:"",right:"",fab:""}},[n("v-icon",[t._v("mdi-plus")]),n("input",{attrs:{type:"file",multiple:""},on:{input:t.dropFile}})],1),n("v-btn",{attrs:{color:"secondary",dark:"",fixed:"",bottom:"",right:"",fab:""},on:{click:function(e){e.stopPropagation(),t.dialog=!0}}},[n("v-icon",[t._v("mdi-arrow-down")])],1)],1),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-card",[n("v-card-title",[t._v("导出文本")]),n("v-card-text",[t._l(t.files,(function(e){return n("v-text-field",{key:e.name,attrs:{label:"文件名",value:e.name,suffix:"."+t.outputFormat},on:{blur:function(t){return e.name=t.target.value}}})})),n("v-radio-group",{attrs:{label:"文件格式",row:""},model:{value:t.outputFormat,callback:function(e){t.outputFormat=e},expression:"outputFormat"}},[n("v-radio",{attrs:{label:"Word",value:"docx"}}),n("v-radio",{attrs:{label:"Text",value:"txt"}})],1)],2),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){e.stopPropagation(),t.dialog=!1}}},[t._v("取消")]),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(e){return e.stopPropagation(),t.downFile(e)}}},[t._v("下载")])],1)],1)],1),n("v-snackbar",{attrs:{timeout:2e3,bottom:""},model:{value:t.snackbar.show,callback:function(e){t.$set(t.snackbar,"show",e)},expression:"snackbar.show"}},[t._v(" "+t._s(t.snackbar.text)+" "),n("v-btn",{attrs:{text:"",color:"secondary"},nativeOn:{click:function(e){t.snackbar.show=!1}}},[t._v("关闭")])],1)],1)},s=[],c=(n("99af"),n("a15b"),n("d81d"),n("13d5"),n("b0c0"),n("d3b7"),n("ac1f"),n("5319"),n("1276"),n("498a"),n("f3f3")),l=n("54f8"),u=(n("96cf"),n("c964")),f=n("d0ff"),p=n("3907"),d=n.n(p),v=n("7c39"),m=n.n(v),b=n("0083"),g=n.n(b),h=n("fbf9"),w=n.n(h),x=n("21a6"),k=function(t,e){return new Promise((function(n){var r=new FileReader;r.onload=function(t){n(t.target.result)},r.readAsText(t,e)}))},y=function(t,e,n){var r=t.split("\n\n");return"all"===n&&e?r=r.map((function(t){return t.split("\n").reduce((function(t,e){return[e].concat(Object(f["a"])(t))}),[]).join("\n")})):"main"===n?r=r.map((function(t){return t.split("\n")[0]})):"sub"===n&&(r=r.map((function(t){return t.split("\n")[1]}))),r.join("\n\n")},_={name:"Index",data:function(){return{windowSize:{x:window.innerWidth,y:window.innerHeight},encoding:"utf-8",outputFormat:"docx",outputRange:"all",outputInvert:!1,files:[{format:"ass",source:"",result:"",name:""}],snackbar:{show:!1,text:""},dialog:!1}},mounted:function(){var t=this;this.$nextTick((function(){t.$refs.source.addEventListener("scroll",t.syncScroll),t.$refs.result.addEventListener("scroll",t.syncScroll),new d.a}))},methods:{getResult:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,n=this.outputInvert,r=this.outputRange;if("srt"===e){var a=t.replace(/\d+\s*(\d+:?){3},\d* --> (\d+:?){3},\d*/g,"").replace(/{\\an.*}/g,"").replace(/{\\pos.*}/g,"").replace(/(\s*\n){3,}/g,"\n\n").trim();return y(a,n,r)}if("ass"===e){var o=t.replace(/[^]*\[Events\]\s*/,"").replace(/Format:.*\s*/,"").replace(/Dialogue.*,,(.*p0})?/g,"\n").replace(/{.*?}/g,"").replace(/\\N/g,"\n").replace(/(\s*\n){3,}/g,"\n\n").trim();return y(o,n,r)}return"txt"===e?t.replace(/(，|。|\.)+/g,"\n"):t},resizeHandler:function(){this.windowSize={x:window.innerWidth,y:window.innerHeight}},switchEncoding:function(){this.encoding="utf-8"===this.encoding?"gb2312":"utf-8";var t=this.files[0];t.raw&&this.dropFile({target:{files:[t.raw]}})},switchFormat:function(){var t=this.files[0];"srt"===t.format?t.format="ass":"ass"===t.format&&(t.format="srt"),this.syncResult()},switchInvert:function(){this.outputInvert=!this.outputInvert,this.syncResult()},switchRange:function(){var t=this.outputRange;this.outputRange="all"===t?"main":"main"===t?"sub":"all",this.syncResult()},dropFile:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a,o,i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=t.target.files||t.dataTransfer.files,a=0;case 2:if(!(a<r.length)){n.next=12;break}return n.next=5,k(r[a],e.encoding);case 5:o=n.sent,i=r[a].name.replace(/.*\./,""),s=r[a].name.replace(".".concat(i),""),e.files[a]={raw:r[a],source:o,format:i,name:s};case 9:a+=1,n.next=2;break;case 12:e.files.length>1&&(e.dialog=!0),e.snackbar={show:!0,text:"字幕导入成功"},e.syncResult();case 15:case"end":return n.stop()}}),n)})))()},downFile:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var n,r,a,o,i,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.files,r=t.outputFormat,a=Object(l["a"])(n),e.prev=2,a.s();case 4:if((o=a.n()).done){e.next=30;break}if(i=o.value,i.name){e.next=9;break}return t.snackbar={show:!0,text:"请输入文件名"},e.abrupt("continue",28);case 9:if(s=i.result||t.getResult(i.source,i.format),c=void 0,"docx"!==r){e.next=24;break}return e.prev=12,e.next=15,t.generateDoc(s);case 15:c=e.sent,e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](12),console.log(e.t0),e.t0&&(t.snackbar={show:!0,text:"出错了..."});case 22:e.next=25;break;case 24:c=new Blob([s.replace(/\r?\n/g,"\r\n")]);case 25:Object(x["saveAs"])(c,"".concat(i.name,".").concat(r)),t.snackbar={show:!0,text:"已导出 ".concat(i.name)},t.dialog=!1;case 28:e.next=4;break;case 30:e.next=35;break;case 32:e.prev=32,e.t1=e["catch"](2),a.e(e.t1);case 35:return e.prev=35,a.f(),e.finish(35);case 38:case"end":return e.stop()}}),e,null,[[2,32,35,38],[12,18]])})))()},generateDoc:function(t){return new Promise((function(e,n){g.a.getBinaryContent("template.docx",(function(r,a){if(r)return n(r);var o=new m.a(a),i=(new w.a).loadZip(o);i.setData({author:"F-loat",content:t.split("\n").map((function(t){return{text:t}}))}),i.render();var s=i.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});e(s)}))}))},syncScroll:function(t){var e=this;clearTimeout(this.scrollTimer);var n=t.target,r=n.scrollTop,a=n.scrollHeight,o=r/a,i=this.$refs,s=i.source,c=i.result,l=t.target===s?c:s;l.removeEventListener("scroll",this.syncScroll),l.scrollTop=l.scrollHeight*o,this.scrollTimer=setTimeout((function(){l.addEventListener("scroll",e.syncScroll)}),300)},syncSource:function(){var t=this.files[0];this.$set(this.files,0,Object(c["a"])(Object(c["a"])({},t),{},{source:t.result}))},syncResult:function(){var t=this.files[0],e=this.getResult(t.source,t.format);this.$set(this.files,0,Object(c["a"])(Object(c["a"])({},t),{},{result:e}))}}},j=_,O=(n("d18d"),n("2877")),R=n("6544"),S=n.n(R),F=n("7496"),T=n("40dc"),V=n("8336"),P=n("b0af"),C=n("99d9"),$=n("169a"),E=n("132d"),I=n("f6c4"),A=n("67b6"),z=n("43a6"),N=n("2db4"),H=n("2fa4"),D=n("8654"),B=n("2a7f"),M=n("3a2f"),L=n("269a"),W=n.n(L),J=n("dc22"),Z=Object(O["a"])(j,i,s,!1,null,"4221dc2f",null),q=Z.exports;S()(Z,{VApp:F["a"],VAppBar:T["a"],VBtn:V["a"],VCard:P["a"],VCardActions:C["a"],VCardText:C["b"],VCardTitle:C["c"],VDialog:$["a"],VIcon:E["a"],VMain:I["a"],VRadio:A["a"],VRadioGroup:z["a"],VSnackbar:N["a"],VSpacer:H["a"],VTextField:D["a"],VToolbarTitle:B["a"],VTooltip:M["a"]}),W()(Z,{Resize:J["a"]});var G={name:"app",components:{Index:q}},K=G,Q=(n("034f"),Object(O["a"])(K,a,o,!1,null,null,null)),U=Q.exports,X=n("f309");r["a"].use(X["a"]);var Y=new X["a"]({theme:{themes:{light:{primary:"#474a4f",secondary:"#ff5252"}}}}),tt=n("9483");Object(tt["a"])("".concat("/caption2text/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}}),r["a"].config.productionTip=!1,new r["a"]({vuetify:Y,render:function(t){return t(U)}}).$mount("#app")},"85ec":function(t,e,n){},d18d:function(t,e,n){"use strict";var r=n("4f49"),a=n.n(r);a.a}});