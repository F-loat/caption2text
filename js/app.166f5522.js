(function(e){function t(t){for(var r,s,i=t[0],c=t[1],l=t[2],f=0,d=[];f<i.length;f++)s=i[f],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&d.push(a[s][0]),a[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(d.length)d.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==a[c]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},a={app:0},o=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/caption2text/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("8a23"),a=n.n(r);a.a},"13af":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Index")},o=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{directives:[{name:"resize",rawName:"v-resize",value:e.resizeHandler,expression:"resizeHandler"}]},[n("v-app-bar",{attrs:{app:"",dark:"",color:"primary"}},[n("v-toolbar-title",{staticClass:"white--text"},[e._v("字幕转换工具")]),n("v-spacer"),n("v-btn",{attrs:{icon:"",dark:""},domProps:{textContent:e._s("<-")},on:{click:e.syncSource}}),n("v-btn",{attrs:{text:"",dark:""},on:{click:e.switchEncoding}},[e._v(e._s(e.encoding))]),n("v-btn",{attrs:{icon:"",dark:""},on:{click:e.switchFormat}},[e._v(e._s(e.files[0].format))]),n("a",{attrs:{href:"https://github.com/F-loat/caption2text",target:"_blank"}},[n("v-btn",{attrs:{icon:"",dark:""}},[n("v-icon",[e._v("mdi-github")])],1)],1)],1),n("v-content",[n("div",{staticClass:"main",on:{drop:function(t){return t.preventDefault(),e.dropFile(t)}}},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.files[0].source,expression:"files[0].source"}],ref:"source",staticClass:"source",attrs:{placeholder:"支持多文件拖入",spellcheck:"false"},domProps:{value:e.files[0].source},on:{input:[function(t){t.target.composing||e.$set(e.files[0],"source",t.target.value)},e.syncResult]}}),e._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.files[0].result,expression:"files[0].result"}],ref:"result",staticClass:"result",attrs:{placeholder:"支持批量导出",spellcheck:"false"},domProps:{value:e.files[0].result},on:{input:function(t){t.target.composing||e.$set(e.files[0],"result",t.target.value)}}})]),n("v-btn",{staticClass:"file-btn",attrs:{color:"secondary",dark:"",fixed:"",bottom:"",right:"",fab:""}},[n("v-icon",[e._v("mdi-plus")]),n("input",{attrs:{type:"file",multiple:""},on:{input:e.dropFile}})],1),n("v-btn",{attrs:{color:"secondary",dark:"",fixed:"",bottom:"",right:"",fab:""},on:{click:function(t){t.stopPropagation(),e.dialog=!0}}},[n("v-icon",[e._v("mdi-arrow-down")])],1)],1),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[e._v("导出文本")]),n("v-card-text",[e._l(e.files,(function(t){return n("v-text-field",{key:t.name,attrs:{label:"文件名",suffix:"."+e.outputFormat},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"file.name"}})})),n("v-radio-group",{attrs:{label:"文件格式",row:""},model:{value:e.outputFormat,callback:function(t){e.outputFormat=t},expression:"outputFormat"}},[n("v-radio",{attrs:{label:"Word",value:"docx"}}),n("v-radio",{attrs:{label:"Text",value:"txt"}})],1)],2),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){t.stopPropagation(),e.dialog=!1}}},[e._v("取消")]),n("v-btn",{attrs:{color:"primary",text:""},on:{click:function(t){return t.stopPropagation(),e.downFile(t)}}},[e._v("下载")])],1)],1)],1),n("v-snackbar",{attrs:{timeout:2e3,bottom:""},model:{value:e.snackbar.show,callback:function(t){e.$set(e.snackbar,"show",t)},expression:"snackbar.show"}},[e._v(" "+e._s(e.snackbar.text)+" "),n("v-btn",{attrs:{text:"",color:"secondary"},nativeOn:{click:function(t){e.snackbar.show=!1}}},[e._v("关闭")])],1)],1)},i=[],c=(n("99af"),n("d81d"),n("b0c0"),n("d3b7"),n("ac1f"),n("5319"),n("1276"),n("498a"),n("5530")),l=n("b85c"),u=(n("96cf"),n("1da1")),f=n("3907"),d=n.n(f),p=n("7c39"),v=n.n(p),m=n("0083"),b=n.n(m),g=n("fbf9"),h=n.n(g),w=n("21a6"),x=function(e,t){return new Promise((function(n){var r=new FileReader;r.onload=function(e){n(e.target.result)},r.readAsText(e,t)}))},k={name:"Index",data:function(){return{windowSize:{x:window.innerWidth,y:window.innerHeight},encoding:"utf-8",outputFormat:"docx",files:[{format:"ass",source:"",result:"",name:""}],snackbar:{show:!1,text:""},dialog:!1}},mounted:function(){var e=this;this.$nextTick((function(){e.$refs.source.addEventListener("scroll",e.syncScroll),e.$refs.result.addEventListener("scroll",e.syncScroll),new d.a}))},methods:{getResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return"srt"===t?e.replace(/(\d+:?){3},\d+ --> (\d+:?){3},\d?/g,"").replace(/\d+/g,"").replace(/{\\an.*}/g,"").replace(/{\\pos.*}/g,"").replace(/(\s*\n){3,}/g,"\n\n").trim():"ass"===t?e.replace(/[^]*\[Events\]\s*/,"").replace(/Format:.*\s*/,"").replace(/Dialogue.*,,(.*p0})?/g,"\n").replace(/{.*?}/g,"").replace(/\\N/g,"\n").replace(/(\s*\n){3,}/g,"\n\n").trim():"txt"===t?e.replace(/(，|。|\.)+/g,"\n"):e},resizeHandler:function(){this.windowSize={x:window.innerWidth,y:window.innerHeight}},switchEncoding:function(){this.encoding="utf-8"===this.encoding?"gb2312":"utf-8";var e=this.files[0];e.raw&&this.dropFile({dataTransfer:{files:[e.raw]}})},switchFormat:function(){var e=this.files[0];"srt"===e.format?e.format="ass":"ass"===e.format&&(e.format="srt"),this.syncResult()},dropFile:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,a,o,s,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=e.target.files||e.dataTransfer.files,a=0;case 2:if(!(a<r.length)){n.next=12;break}return n.next=5,x(r[a],t.encoding);case 5:o=n.sent,s=r[a].name.replace(/.*\./,""),i=r[a].name.replace(".".concat(s),""),t.files[a]={raw:r[a],source:o,format:s,name:i};case 9:a+=1,n.next=2;break;case 12:t.files.length>1&&(t.dialog=!0),t.snackbar={show:!0,text:"字幕导入成功"},t.syncResult();case 15:case"end":return n.stop()}}),n)})))()},downFile:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r,a,o,s,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.files,r=e.outputFormat,a=Object(l["a"])(n),t.prev=2,a.s();case 4:if((o=a.n()).done){t.next=29;break}if(s=o.value,s.name){t.next=9;break}return e.snackbar={show:!0,text:"请输入文件名"},t.abrupt("continue",27);case 9:if(i=s.result||e.getResult(s.source,s.format),c=void 0,"docx"!==r){t.next=23;break}return t.prev=12,t.next=15,e.generateDoc(i);case 15:c=t.sent,t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](12),t.t0&&(e.snackbar={show:!0,text:"出错了..."});case 21:t.next=24;break;case 23:c=new Blob([i.replace(/\r?\n/g,"\r\n")]);case 24:Object(w["saveAs"])(c,"".concat(s.name,".").concat(r)),e.snackbar={show:!0,text:"已导出 ".concat(s.name)},e.dialog=!1;case 27:t.next=4;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t["catch"](2),a.e(t.t1);case 34:return t.prev=34,a.f(),t.finish(34);case 37:case"end":return t.stop()}}),t,null,[[2,31,34,37],[12,18]])})))()},generateDoc:function(e){return new Promise((function(t,n){b.a.getBinaryContent("template.docx",(function(r,a){if(r)return n(r);var o=new v.a(a),s=(new h.a).loadZip(o);s.setData({author:"F-loat",content:e.split("\n").map((function(e){return{text:e}}))}),s.render();var i=s.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});t(i)}))}))},syncScroll:function(e){var t=this;clearTimeout(this.scrollTimer);var n=e.target,r=n.scrollTop,a=n.scrollHeight,o=r/a,s=this.$refs,i=s.source,c=s.result,l=e.target===i?c:i;l.removeEventListener("scroll",this.syncScroll),l.scrollTop=l.scrollHeight*o,this.scrollTimer=setTimeout((function(){l.addEventListener("scroll",t.syncScroll)}),300)},syncSource:function(){var e=this.files[0];this.$set(this.files,0,Object(c["a"])(Object(c["a"])({},e),{},{source:e.result}))},syncResult:function(){var e=this.files[0],t=this.getResult(e.source,e.format);this.$set(this.files,0,Object(c["a"])(Object(c["a"])({},e),{},{result:t}))}}},y=k,_=(n("de7d"),n("2877")),O=n("6544"),j=n.n(O),F=n("7496"),T=n("40dc"),S=n("8336"),V=n("b0af"),P=n("99d9"),R=n("a75b"),C=n("169a"),$=n("132d"),E=n("67b6"),z=n("43a6"),A=n("2db4"),H=n("2fa4"),N=n("8654"),D=n("2a7f"),B=n("269a"),I=n.n(B),L=n("dc22"),M=Object(_["a"])(y,s,i,!1,null,"e2fbde42",null),W=M.exports;j()(M,{VApp:F["a"],VAppBar:T["a"],VBtn:S["a"],VCard:V["a"],VCardActions:P["a"],VCardText:P["b"],VCardTitle:P["c"],VContent:R["a"],VDialog:C["a"],VIcon:$["a"],VRadio:E["a"],VRadioGroup:z["a"],VSnackbar:A["a"],VSpacer:H["a"],VTextField:N["a"],VToolbarTitle:D["a"]}),I()(M,{Resize:L["a"]});var J={name:"app",components:{Index:W}},Z=J,q=(n("034f"),Object(_["a"])(Z,a,o,!1,null,null,null)),G=q.exports,K=n("f309");r["a"].use(K["a"]);var Q=new K["a"]({theme:{themes:{light:{primary:"#474a4f",secondary:"#ff5252"}}}}),U=n("9483");Object(U["a"])("".concat("/caption2text/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),r["a"].config.productionTip=!1,new r["a"]({vuetify:Q,render:function(e){return e(G)}}).$mount("#app")},"8a23":function(e,t,n){},de7d:function(e,t,n){"use strict";var r=n("13af"),a=n.n(r);a.a}});