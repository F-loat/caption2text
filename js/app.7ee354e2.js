(function(e){function t(t){for(var r,c,s=t[0],i=t[1],l=t[2],f=0,d=[];f<s.length;f++)c=s[f],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&d.push(o[c][0]),o[c]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r]);u&&u(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var i=n[s];0!==o[i]&&(r=!1)}r&&(a.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},o={app:0},a=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/caption2text/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=i;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("85ec"),o=n.n(r);o.a},"252f":function(e,t,n){"use strict";var r=n("50e8"),o=n.n(r);o.a},"50e8":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r,o,a=n("2b0e"),c=n("ce5b"),s=n.n(c),i=(n("d1e78"),n("bf40"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Index")}),l=[],u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{directives:[{name:"resize",rawName:"v-resize",value:e.resizeHandler,expression:"resizeHandler"}]},[n("v-toolbar",{attrs:{dark:"",color:"primary"}},[n("v-toolbar-title",{staticClass:"white--text"},[e._v("字幕转文本工具")]),n("v-spacer"),n("v-btn",{attrs:{icon:"",dark:""},domProps:{textContent:e._s("<-")},on:{click:e.switchSource}}),n("v-btn",{attrs:{flat:"",dark:""},on:{click:e.switchEncoding}},[e._v(e._s(e.encoding))]),n("v-btn",{attrs:{icon:"",dark:""},on:{click:e.switchFormat}},[e._v(e._s(e.files[0].format))]),n("a",{attrs:{href:"https://github.com/F-loat/caption2text",target:"_blank"}},[n("v-btn",{attrs:{icon:"",dark:""}},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 16 16",version:"1.1",width:"24","aria-hidden":"true"}},[n("path",{attrs:{"fill-rule":"evenodd",fill:"#fff",d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"}})])])],1)],1),n("div",{staticClass:"main",on:{drop:function(t){return t.preventDefault(),e.dropFile(t)}}},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.files[0].source,expression:"files[0].source"}],ref:"source",staticClass:"source",attrs:{placeholder:"支持多文件拖入"},domProps:{value:e.files[0].source},on:{input:function(t){t.target.composing||e.$set(e.files[0],"source",t.target.value)}}}),n("textarea",{ref:"result",staticClass:"result",class:{holder:!e.files[0].source},attrs:{readonly:""},domProps:{value:e.files[0].source?e.getResult(e.files[0].source,e.files[0].format):"支持批量导出"}})]),n("v-btn",{attrs:{color:"secondary",dark:"",fixed:"",bottom:"",right:"",fab:""},on:{click:function(t){t.stopPropagation(),e.dialog=!0}}},[n("v-icon",[e._v("get_app")])],1),n("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",[e._v("导出文本")]),n("v-card-text",[e._l(e.files,(function(t){return n("v-text-field",{key:t.name,attrs:{label:"文件名",suffix:"."+e.outputFormat},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"file.name"}})})),n("v-radio-group",{attrs:{label:"文件格式",row:""},model:{value:e.outputFormat,callback:function(t){e.outputFormat=t},expression:"outputFormat"}},[n("v-radio",{attrs:{label:"Word",value:"docx"}}),n("v-radio",{attrs:{label:"Text",value:"txt"}})],1)],2),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(t){t.stopPropagation(),e.dialog=!1}}},[e._v("取消")]),n("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(t){return t.stopPropagation(),e.downFile(t)}}},[e._v("下载")])],1)],1)],1),n("v-snackbar",{attrs:{timeout:2e3,bottom:""},model:{value:e.snackbar.show,callback:function(t){e.$set(e.snackbar,"show",t)},expression:"snackbar.show"}},[e._v(" "+e._s(e.snackbar.text)+" "),n("v-btn",{attrs:{flat:"",color:"secondary"},nativeOn:{click:function(t){e.snackbar.show=!1}}},[e._v("Close")])],1)],1)},f=[],d=(n("99af"),n("d81d"),n("b0c0"),n("d3b7"),n("ac1f"),n("5319"),n("1276"),n("b85c")),p=(n("96cf"),n("1da1")),v=n("3907"),h=n.n(v),g=n("7c39"),m=n.n(g),b=n("0083"),w=n.n(b),x=n("fbf9"),k=n.n(x),y=n("21a6"),_={name:"Index",data:function(){return{windowSize:{x:window.innerWidth,y:window.innerHeight},encoding:"utf-8",outputFormat:"docx",files:[{format:"ass",source:""}],snackbar:{show:!1,text:""},dialog:!1}},mounted:function(){var e=this;this.$nextTick((function(){e.$refs.source.addEventListener("scroll",e.scrollSync),e.$refs.result.addEventListener("scroll",e.scrollSync),new h.a}))},methods:{getResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return"srt"===t?e.replace(/(\d+:?){3},\d+ --> (\d+:?){3},\d?/g,"").replace(/\d+\s*\n/g,"").replace(/{\\an.*}/g,"").replace(/{\\pos.*}/g,""):"ass"===t?e.replace(/[^]*\[Events\]\s*/,"").replace(/Format:.*\s*/,"").replace(/Dialogue.*,,(.*p0})?/g,"\n").replace(/{.*?}/g,"").replace(/\\N/g,"\n").replace(/(\s*\n){3,}/g,"\n\n"):"txt"===t?e.replace(/(，|。|\.)+/g,"\n"):e},resizeHandler:function(){this.windowSize={x:window.innerWidth,y:window.innerHeight}},switchEncoding:function(){this.encoding="utf-8"===this.encoding?"gb2312":"utf-8",this.dropFile(null,r)},switchFormat:function(){this.format="ass"===this.format?"srt":"ass"},switchSource:function(){var e=this.files[0],t=e.source,n=e.format,r=this.getResult(t,n);this.$set(this.files,"0",{source:r,format:n})},dropFile:function(e,t){for(var n=this,r=t?[t]:e.dataTransfer.files,o=function(e){var t={},o=new FileReader;o.onload=function(e){t.source=e.target.result},o.readAsText(r[e],n.encoding),t.format=r[e].name.replace(/.*\./,""),t.name=r[e].name.replace(".".concat(t.format),""),n.files[e]=t},a=0;a<r.length;a+=1)o(a);this.files.length>1&&(this.dialog=!0),this.snackbar={show:!0,text:"字幕导入成功"}},downFile:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){var n,r,o,a,c,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.files,r=e.outputFormat,o=Object(d["a"])(n),t.prev=2,o.s();case 4:if((a=o.n()).done){t.next=29;break}if(c=a.value,c.name){t.next=9;break}return e.snackbar={show:!0,text:"请输入文件名"},t.abrupt("continue",27);case 9:if(s=e.getResult(c.source,c.format),i=void 0,"docx"!==r){t.next=23;break}return t.prev=12,t.next=15,e.generateDoc(s);case 15:i=t.sent,t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](12),t.t0&&(e.snackbar={show:!0,text:"出错了..."});case 21:t.next=24;break;case 23:i=new Blob([s.replace(/\r?\n/g,"\r\n")]);case 24:Object(y["saveAs"])(i,"".concat(c.name,".").concat(r)),e.snackbar={show:!0,text:"已导出 ".concat(c.name)},e.dialog=!1;case 27:t.next=4;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t["catch"](2),o.e(t.t1);case 34:return t.prev=34,o.f(),t.finish(34);case 37:case"end":return t.stop()}}),t,null,[[2,31,34,37],[12,18]])})))()},generateDoc:function(e){return new Promise((function(t,n){w.a.getBinaryContent("template.docx",(function(r,o){if(r)return n(r);console.log(o);var a=new m.a(o),c=(new k.a).loadZip(a);c.setData({author:"F-loat",content:e.split("\n").map((function(e){return{text:e}}))}),c.render();var s=c.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});console.log(s),t(s)}))}))},scrollSync:function(e){var t=this;clearTimeout(o);var n=e.target,r=n.scrollTop,a=n.scrollHeight,c=r/a,s=this.$refs,i=s.source,l=s.result,u=e.target===i?l:i;u.removeEventListener("scroll",this.scrollSync),u.scrollTop=u.scrollHeight*c,o=setTimeout((function(){u.addEventListener("scroll",t.scrollSync)}),300)}}},F=_,O=(n("252f"),n("2877")),j=Object(O["a"])(F,u,f,!1,null,"c50c8d16",null),P=j.exports,S={name:"app",components:{Index:P}},T=S,$=(n("034f"),Object(O["a"])(T,i,l,!1,null,null,null)),E=$.exports,C=n("9483");Object(C["a"])("".concat("/caption2text/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),a["default"].config.productionTip=!1,a["default"].use(s.a,{theme:{primary:"#474a4f",secondary:"#ff5252"}}),new a["default"]({render:function(e){return e(E)}}).$mount("#app")},"85ec":function(e,t,n){}});